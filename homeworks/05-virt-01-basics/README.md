### Вопросы-ответы:
####---------------------------------------------

### Задача 1: Опишите кратко, в чём основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

### Ответ:

***Аппаратная виртуализация*** - позволяет запускать несколько виртуальных машин на одном физическом сервере, при этом полностью эмулируется аппаратное обеспечение (ЦП, Диски, Память и тд.)
Пример: hyper-v, VMware

***Паравиртуализация*** - это модификация гостевой ОС для работы с гипервизором, ОС обычно адаптирована для паравиртуализации.
Из преимуществ данного метода виртуализации, это то, что нет необходимости эмулировать "железо" для работы между ОС и гипервизором.
Соответственно - значительный прирост производительности.
Пример: KVM

***Виртуализация на основе ОС*** - она же "контейнерная виртуализация", работает на уровне гостевой ОС, где вместо полноценной виртуализации или паравиртуализации используются контейнеры, которые предоставляют изолированную среду для приложений.
Преимущества данного типа в том, что контейнеры легковесны и легко масштабируемы - нет необходимости полностью копировать ОС со
всеми библиотеками и системными файлами для изолированного запуска одного приложения,
потому что они используют общую операционную систему ядра с гостевой системой.
Пример: Kubernetes, Docker

####---------------------------------------------

### Задача 2: Выберите один из вариантов использования организации физических серверов в зависимости от условий использования.

### Организация серверов:
#### - физические сервера,
#### - паравиртуализация,
#### - виртуализация уровня ОС.

#### Условия использования:
#### - высоконагруженная база данных, чувствительная к отказу;
#### - различные web-приложения;
#### - Windows-системы для использования бухгалтерским отделом;
#### - системы, выполняющие высокопроизводительные расчёты на GPU.

### Опишите, почему вы выбрали к каждому целевому использованию такую организацию.

### Ответ:

#### Физические сервера:
- высоконагруженная база данных, чувствительная к отказу  

*Для высоконагруженной базы данных, чувствительной к отказу, рекомендуется использовать полную (аппаратную) виртуализацию или паравиртуализацию.*
*Полная виртуализация обеспечивает изоляцию и полное эмулирование аппаратного обеспечения виртуальных машин. Это означает, что каждая виртуальная машина работает в собственной виртуальной среде и не влияет на другие виртуальные машины или хостовую систему. Это особенно важно для высоконагруженных баз данных, где требуется высокая производительность и надежность.* 
*Паравиртуализация также представляет отличный вариант для высоконагруженных баз данных. В отличие от полной виртуализации, при паравиртуализации гостевые операционные системы виртуальных машин являются осведомленными о своем виртуальном окружении и взаимодействуют напрямую с гипервизором. Это может привести к лучшей производительности и управляемости, поскольку виртуализированные операционные системы имеют более низкие накладные расходы на эмуляцию аппаратного обеспечения.*


#### Паравиртуализация: 
- системы, выполняющие высокопроизводительные расчёты на GPU  

*Паравиртуализация подразумевает модификацию гостевой операционной системы для работы с гипервизором, которая позволяет предоставить виртуальной машине доступ к ресурсам GPU. В гостевых операционных системах, специально адаптированных для паравиртуализации, внесены изменения, которые позволяют им "знать" о своем виртуальном окружении и использовать доступные GPU ресурсы без эмуляции. Это может привести к более высокой производительности вычислений на GPU по сравнению с полной эмуляцией аппаратного обеспечения.*

#### Виртуализация уровня ОС:
 - различные web-приложения  

Какое-либо web-приложение обычно состоит из множества других приложений. Как пример, web-сервер Nginx в любом случае будет использовать какую-нибудь базу данных,
соответственно

 - Windows-системы для использования бухгалтерским отделом

*Рекомендуется использовать виртуализацию на основе ОС (контейнерную виртуализацию) или паравиртуализацию.*
*Контейнерная виртуализация позволяет запускать различные приложения и сервисы в изолированных контейнерах, которые разделяют общую операционную систему (OS). Это особенно полезно для бухгалтерского отдела, где обычно требуется запуск нескольких приложений, таких как программы для бухгалтерии и электронных таблиц. Примером платформы для контейнерной виртуализации является Docker, который позволяет создавать и управлять контейнерами в Windows-системах.*
*Паравиртуализация, как уже упоминалось ранее, также может быть хорошим выбором для Windows-системы в бухгалтерском отделе. В этом случае, гостевая операционная система модифицируется для работы с гипервизором и активно взаимодействует с ним, что обеспечивает более высокую производительность, чем полная виртуализация*
*Выбор между виртуализацией на основе ОС и паравиртуализацией зависит от конкретных требований и предпочтений твоего бухгалтерского отдела*

####---------------------------------------------

### Задача 3: Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

#### Сценарии:

#### 1) 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based-инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
#### 2) Требуется наиболее производительное бесплатное open source-решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
#### 3) Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows-инфраструктуры.
#### 4) Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

### Ответ:

1) Исходя их того, что нет запрета на использование проприетарных гипервзиоров, с учётом количества серверов и
распределённых задач, объединяющих ОС Linux и Windows, прекрасным решением будет VMware (например "Workstation PRO"). Тонкая настройка межсетевых экранов и "мостов",
и возможность сделать быстро snapshot любой из ВМ позволяет настроить ту работу с виртуальным окружением, которая необходима именно компании.
VMware одинаково хорошо умеет "дружить" как с Linux, так и с Windows, и даже имеются присеты настроек установки, в зависимости от версии Windows
или он дистрибутива Linux.
####
2) Здесь подойдёт Proxmox VE, он поддерживает обе ОС и обеспечивает высокую производительность, поскольку является серьёзным решением виртуализации
для многих компаний с подобными требованиями к их юудущей инфраструктуре. Proxmox VE использует встроенную в Linux ядро технологию KVM (Kernel Virtual Machine) для обеспечения полной виртуализации,
которая позволяет запускать гостевые операционные системы Windows и других ОС. При использовании KVM, гостевые операционные системы, включая Windows, могут работать практически полностью нативно,
с полным доступом к ресурсам хостовой системы. И в конце-концов - это Opensource.
####
3) Для виртуализации виртуальной Windows-инфраструктуры лучше, чем Hyper-V - придумать нельзя. Абсолютно нативное использование с тонкими настройками именно под Windows, максимальная совместимость с железом
и высокая производительность делают Hyper-V лучшей практикой в постороении windows-инфраструктуры.
В конце-концов - Hyper-V и Windows разработаны одной компанией, Microsoft. К тому же, в последних версиях Windows присутствует Hyper-V,
его достаточно просто включить.
####
4) KVM является, пожалуй, самым нативным и лучшим решением для виртуальных машин на базе Linux, поскольку в независимости от дистрибутива,
KVM обеспечивает лучшую производительность и полную совместимость компонентов гостевой ОС, например таких как драйвера, диски, ресурсы ЦП и тд.
KVM полностью интегрировано в ядро Linux и работает в качестве модуля ядра. Он добавляет специальные драйверы,
которые позволяют управлять аппаратным обеспечением и создавать виртуальные машины на уровне ядра Linux.
К тому-же, KVM - это Opensource, что уже плюс.

####---------------------------------------------

### Задача 4: Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

### Ответ:

Корень проблем такого подхода в отсутствии "монолитности" всей инфраструктуры. Если используется несколько VDI одновременно, то могут появиться такие проблемы, как
например, один и тот же дистрибутив/версия ОС на разных VDI может не корректно устанавливаться, некорректно видить ресурсы и драйверы.

Из минусов:  
- нет единого пространства ресурсов, IP адресов и имён (нельзя просто так отсоединить виртуальный диск из ВМ одной VDI и подключить его в ВМ другой VDI),
а регистрация одинаковых IP адресов и имен создаёт не только визуальную путаницу, но и проблемы при построении сети
- нельзя применить снапшоты из одной VDI в другую
- масштабируемость будет занимать больше времени
- мониторинг будет сложнее, поиск проблем (если нет распределения "конкретный сервис = конкретный VDI") будет значительно дольше

Для минимизации подобных проблем следует использовать "программы-посредники", которые помогают решить возможные кофликты двух VDI.
Например, можно использовать внешнее хранилище (например у клауд-провайдера), которое будет доступно по API,
использовать общий сервис для хранения credentials (такой как Doppler), и соответтсвенно вести посуточный мониторинг ВМ.
Также, можно построить инфраструктуру таким образом, чтобы распределить конкретные зоны ответственности сервисов на определённые VDI (т.е. "конкретный сервис = конкретный VDI".
Проще говоря: построить CI/CD, локальный Git репозиторий и основную БД на KVM (например с ВМ на базе Debian), а мониторинг и базу 1С на Hyper-V (например на Windows Server 2019).
Исходя из вышеперечисленных фактов, я как инженер, отказался от варианта организации гетерогенной среды виртуализации.
С моей точки зрения, было бы логичнее и проще (а значит отказоустойчивее) собрать архитектуру с одной VDI, так как дебаг и масштабируемость крайне важны
в построении бизнес-приложения (по выше перечисленным примерам). С другой стороны, проблемы таких вопросов давно решены сторонними VDS-провайдерами,
поскольку вся инфраструктура монолитна и находится в облаке, а значит что пространства имен, IP адреса и ресурсы модульны, а сокет каждой ВМ способен принять их. 

